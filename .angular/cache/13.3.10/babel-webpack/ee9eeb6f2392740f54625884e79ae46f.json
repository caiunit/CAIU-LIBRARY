{"ast":null,"code":"import _toConsumableArray from \"C:\\\\Users\\\\dsalgado.contr\\\\source\\\\Workspaces\\\\CAIU-LIBRARY\\\\CAIU-LIBRARY\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\toConsumableArray.js\";\nimport _classCallCheck from \"C:\\\\Users\\\\dsalgado.contr\\\\source\\\\Workspaces\\\\CAIU-LIBRARY\\\\CAIU-LIBRARY\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"C:\\\\Users\\\\dsalgado.contr\\\\source\\\\Workspaces\\\\CAIU-LIBRARY\\\\CAIU-LIBRARY\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport _inherits from \"C:\\\\Users\\\\dsalgado.contr\\\\source\\\\Workspaces\\\\CAIU-LIBRARY\\\\CAIU-LIBRARY\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\inherits.js\";\nimport _createSuper from \"C:\\\\Users\\\\dsalgado.contr\\\\source\\\\Workspaces\\\\CAIU-LIBRARY\\\\CAIU-LIBRARY\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createSuper.js\";\nimport { forwardRef, EventEmitter } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ConfirmDeleteComponent } from '../dialog/confirm-delete/confirm-delete.component';\nimport { DumbComponent } from '../../shared/component';\nimport { Address } from '../../shared/models';\nimport { build, compareDates } from '../../shared/utils';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/material/button\";\nimport * as i4 from \"@angular/material/icon\";\nimport * as i5 from \"./inline-address/inline-address.component\";\nimport * as i6 from \"./address-form/address-form.component\";\n\nfunction AddressComponent_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function AddressComponent_button_4_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      var ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.addNew();\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"add\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction AddressComponent_button_5_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function AddressComponent_button_5_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      var ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.back();\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"arrow_back\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction AddressComponent_div_6_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"div\", 11)(2, \"div\", 12)(3, \"div\", 13)(4, \"iu-inline-address\", 14);\n    i0.ɵɵlistener(\"delete\", function AddressComponent_div_6_div_4_Template_iu_inline_address_delete_4_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      var ctx_r10 = i0.ɵɵnextContext(2);\n      return ctx_r10.remove($event);\n    })(\"edit\", function AddressComponent_div_6_div_4_Template_iu_inline_address_edit_4_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      var ctx_r12 = i0.ɵɵnextContext(2);\n      return ctx_r12.edit($event);\n    });\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    var ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"address\", ctx_r8.primaryAddress)(\"canActivate\", false)(\"canDelete\", true)(\"canEdit\", true)(\"showName\", ctx_r8.showName);\n  }\n}\n\nfunction AddressComponent_div_6_iu_inline_address_10_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"iu-inline-address\", 15);\n    i0.ɵɵlistener(\"activate\", function AddressComponent_div_6_iu_inline_address_10_Template_iu_inline_address_activate_0_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      var ctx_r14 = i0.ɵɵnextContext(2);\n      return ctx_r14.makePrimary($event);\n    })(\"delete\", function AddressComponent_div_6_iu_inline_address_10_Template_iu_inline_address_delete_0_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      var ctx_r16 = i0.ɵɵnextContext(2);\n      return ctx_r16.remove($event);\n    })(\"edit\", function AddressComponent_div_6_iu_inline_address_10_Template_iu_inline_address_edit_0_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      var ctx_r17 = i0.ɵɵnextContext(2);\n      return ctx_r17.edit($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var choice_r13 = ctx.$implicit;\n    var ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"canActivate\", ctx_r9.hasPrimaryAddress)(\"canDelete\", true)(\"canEdit\", true)(\"showName\", ctx_r9.showName)(\"address\", choice_r13);\n  }\n}\n\nfunction AddressComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"div\", 1)(2, \"h4\", 2);\n    i0.ɵɵtext(3, \"Current Address\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(4, AddressComponent_div_6_div_4_Template, 5, 5, \"div\", 4);\n    i0.ɵɵelementStart(5, \"div\", 1)(6, \"h4\", 2);\n    i0.ɵɵtext(7, \"Other Addresses\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 8)(9, \"div\", 9);\n    i0.ɵɵtemplate(10, AddressComponent_div_6_iu_inline_address_10_Template, 1, 5, \"iu-inline-address\", 10);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    var ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.primaryAddress);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.choices);\n  }\n}\n\nfunction AddressComponent_iu_address_form_7_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r19 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"iu-address-form\", 16);\n    i0.ɵɵlistener(\"save\", function AddressComponent_iu_address_form_7_Template_iu_address_form_save_0_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      var ctx_r18 = i0.ɵɵnextContext();\n      return ctx_r18.save($event);\n    })(\"delete\", function AddressComponent_iu_address_form_7_Template_iu_address_form_delete_0_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      var ctx_r20 = i0.ɵɵnextContext();\n      return ctx_r20.remove($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"address\", ctx_r3.current)(\"canDelete\", true)(\"hasPrimaryAddress\", ctx_r3.hasPrimaryAddress)(\"showName\", ctx_r3.showName)(\"manager\", true)(\"requireEffectiveDate\", ctx_r3.requireEffectiveDate)(\"zipPlus4\", ctx_r3.zipPlus4)(\"debug\", ctx_r3.debug);\n  }\n}\n\nexport var ADDRESS_ACCESSOR = {\n  provide: NG_VALUE_ACCESSOR,\n  useExisting: forwardRef(function () {\n    return AddressComponent;\n  }),\n  multi: true\n};\nexport var AddressComponent = /*#__PURE__*/(function () {\n  var AddressComponent = /*#__PURE__*/function (_DumbComponent) {\n    _inherits(AddressComponent, _DumbComponent);\n\n    var _super = _createSuper(AddressComponent);\n\n    function AddressComponent(dialog) {\n      var _this;\n\n      _classCallCheck(this, AddressComponent);\n\n      _this = _super.call(this);\n      _this.dialog = dialog;\n      _this._addresses = [];\n      _this.debug = false;\n      _this.editing = false;\n      _this.hasPrimaryAddress = true;\n      _this.requireEffectiveDate = false;\n      _this.showName = true;\n      _this.zipPlus4 = true;\n      _this.activate = new EventEmitter();\n      _this.add = new EventEmitter();\n      _this.delete = new EventEmitter();\n      _this.update = new EventEmitter();\n      _this.errorMessage = '';\n      return _this;\n    }\n\n    _createClass(AddressComponent, [{\n      key: \"addresses\",\n      get: function get() {\n        return this._addresses.findIndex(function (x) {\n          return x.isPrimaryAddress;\n        }) === -1 ? this._addresses.map(function (x, index) {\n          return index === 0 ? build(Address, x, {\n            isPrimaryAddress: true\n          }) : x;\n        }) : this._addresses;\n      },\n      set: function set(value) {\n        this._addresses = value;\n        this.changeValue(this._addresses);\n      }\n    }, {\n      key: \"value\",\n      get: function get() {\n        return this._value;\n      },\n      set: function set(value) {\n        this._value = value;\n      }\n    }, {\n      key: \"choices\",\n      get: function get() {\n        return this.addresses.filter(function (x, i) {\n          return !x.isPrimaryAddress;\n        });\n      }\n    }, {\n      key: \"primaryAddress\",\n      get: function get() {\n        return this.addresses.length === 0 ? null : this.addresses.find(function (x) {\n          return x.isPrimaryAddress;\n        }) || build(Address, this.addresses[0]);\n      },\n      set: function set(value) {\n        this.addresses = [build(Address, value, {\n          isPrimaryAddress: true\n        })].concat(_toConsumableArray(this.removeAddress(value).map(function (x) {\n          return build(Address, x, {\n            isPrimaryAddress: false\n          });\n        })));\n      }\n    }, {\n      key: \"showChoices\",\n      get: function get() {\n        return this.totalChoices > 0;\n      }\n    }, {\n      key: \"totalChoices\",\n      get: function get() {\n        return this.addresses.length;\n      }\n    }, {\n      key: \"ngOnInit\",\n      value: function ngOnInit() {}\n    }, {\n      key: \"registerOnChange\",\n      value: function registerOnChange(fn) {\n        this.onModelChange = fn;\n      }\n    }, {\n      key: \"registerOnTouched\",\n      value: function registerOnTouched(fn) {\n        this.onTouch = fn;\n      }\n    }, {\n      key: \"setDisabledState\",\n      value: function setDisabledState(isDisabled) {}\n    }, {\n      key: \"writeValue\",\n      value: function writeValue(value) {\n        if (this.debug) {\n          console.log('\\nWRITE Address Manager VALUE');\n          console.dir(value);\n        }\n\n        this.value = value;\n      }\n    }, {\n      key: \"changeValue\",\n      value: function changeValue(value) {\n        if (this.debug) {\n          console.log('\\nCHANGE Address Manager VALUE');\n          console.dir(value);\n        }\n\n        this.value = value;\n\n        if (this.onModelChange) {\n          this.onModelChange(value);\n        }\n      }\n    }, {\n      key: \"makePrimary\",\n      value: function makePrimary(e) {\n        this.primaryAddress = e;\n        this.activate.emit(e);\n      }\n    }, {\n      key: \"addNew\",\n      value: function addNew() {\n        this.current = new Address();\n        this.editing = true;\n      }\n    }, {\n      key: \"addressExists\",\n      value: function addressExists(e) {\n        return this.addresses.findIndex(function (x) {\n          return x.address1 === e.address1 && x.cityStateZip === e.cityStateZip;\n        }) !== -1;\n      }\n    }, {\n      key: \"flashAddressExistsMessage\",\n      value: function flashAddressExistsMessage() {\n        var _this2 = this;\n\n        this.errorMessage = 'Cannot enter duplicate address!';\n        setTimeout(function () {\n          _this2.errorMessage = '';\n        }, 4000);\n      }\n    }, {\n      key: \"back\",\n      value: function back() {\n        if (this.current.id === 0) {\n          this.addresses = this.removeAddress(this.current);\n        }\n\n        this.editing = false;\n      }\n    }, {\n      key: \"closeDialog\",\n      value: function closeDialog(e) {\n        if (e) {\n          this.addresses = this.removeAddress(this.toBeDeleted);\n          this.delete.emit(this.toBeDeleted);\n          this.toBeDeleted = undefined;\n          this.editing = false;\n        }\n      }\n    }, {\n      key: \"remove\",\n      value: function remove(e) {\n        this.toBeDeleted = e;\n        this.openDialog(ConfirmDeleteComponent);\n      }\n    }, {\n      key: \"edit\",\n      value: function edit(e) {\n        this.current = e;\n        this.editing = true;\n      }\n    }, {\n      key: \"save\",\n      value: function save(e) {\n        if (!this.addressExists(e)) {\n          this.addresses = this.setActiveDates(this.addAddress(e));\n\n          if (e.id) {\n            this.add.emit(e);\n          } else {\n            this.update.emit(e);\n          }\n\n          this.editing = false;\n        } else if (!this.toBeDeleted) {\n          this.flashAddressExistsMessage();\n        }\n      }\n    }, {\n      key: \"addAddress\",\n      value: function addAddress(address) {\n        return this.reorder([address].concat(_toConsumableArray(this.addresses.filter(function (x) {\n          return x.id === 0 || x.id !== address.id;\n        }).map(function (x) {\n          return address.isPrimaryAddress && x.isPrimaryAddress && x.id !== address.id ? build(Address, x, {\n            isPrimaryAddress: false\n          }) : build(Address, x);\n        }))));\n      }\n    }, {\n      key: \"removeAddress\",\n      value: function removeAddress(address) {\n        return this.addresses.filter(function (x) {\n          return x !== address;\n        });\n      }\n    }, {\n      key: \"reorder\",\n      value: function reorder(addresses) {\n        return addresses.reduce(function (acc, x) {\n          return x.isPrimaryAddress ? [x].concat(_toConsumableArray(acc)) : [].concat(_toConsumableArray(acc), [x]);\n        }, []);\n      }\n    }, {\n      key: \"setActiveDates\",\n      value: function setActiveDates(addresses) {\n        var ordered = addresses.sort(function (a, b) {\n          return compareDates(a.effectiveDate, b.effectiveDate);\n        }).reverse();\n        var now = new Date();\n        return ordered.map(function (x, i) {\n          var startDate = x.effectiveDate;\n          var endDate = ordered[i + 1] && ordered[i + 1].effectiveDate && ordered[i + 1].effectiveDate > x.effectiveDate ? ordered[i + 1].effectiveDate : null;\n          var isPrimaryAddress = x.isPrimaryAddress || (startDate < now && endDate > now ? true : false);\n          return build(Address, x, {\n            startDate: startDate,\n            endDate: endDate,\n            isPrimaryAddress: isPrimaryAddress\n          });\n        });\n      }\n    }]);\n\n    return AddressComponent;\n  }(DumbComponent);\n\n  AddressComponent.ɵfac = function AddressComponent_Factory(t) {\n    return new (t || AddressComponent)(i0.ɵɵdirectiveInject(i1.MatDialog));\n  };\n\n  AddressComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddressComponent,\n    selectors: [[\"iu-address\"]],\n    inputs: {\n      debug: \"debug\",\n      editing: \"editing\",\n      hasPrimaryAddress: \"hasPrimaryAddress\",\n      requireEffectiveDate: \"requireEffectiveDate\",\n      showName: \"showName\",\n      zipPlus4: \"zipPlus4\",\n      addresses: \"addresses\"\n    },\n    outputs: {\n      activate: \"activate\",\n      add: \"add\",\n      delete: \"delete\",\n      update: \"update\"\n    },\n    features: [i0.ɵɵProvidersFeature([ADDRESS_ACCESSOR]), i0.ɵɵInheritDefinitionFeature],\n    decls: 10,\n    vars: 5,\n    consts: [[1, \"card\", \"address\", \"scrollable\"], [1, \"card-header\"], [1, \"card-title\"], [\"mat-mini-fab\", \"\", \"color\", \"primary\", \"class\", \"action-icon\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"card-body\", 4, \"ngIf\"], [3, \"address\", \"canDelete\", \"hasPrimaryAddress\", \"showName\", \"manager\", \"requireEffectiveDate\", \"zipPlus4\", \"debug\", \"save\", \"delete\", 4, \"ngIf\"], [\"id\", \"error-message\"], [\"mat-mini-fab\", \"\", \"color\", \"primary\", 1, \"action-icon\", 3, \"click\"], [1, \"card-body\"], [1, \"body-content\", \"choose-address\"], [3, \"canActivate\", \"canDelete\", \"canEdit\", \"showName\", \"address\", \"activate\", \"delete\", \"edit\", 4, \"ngFor\", \"ngForOf\"], [1, \"body-content\"], [1, \"row\"], [1, \"col\"], [3, \"address\", \"canActivate\", \"canDelete\", \"canEdit\", \"showName\", \"delete\", \"edit\"], [3, \"canActivate\", \"canDelete\", \"canEdit\", \"showName\", \"address\", \"activate\", \"delete\", \"edit\"], [3, \"address\", \"canDelete\", \"hasPrimaryAddress\", \"showName\", \"manager\", \"requireEffectiveDate\", \"zipPlus4\", \"debug\", \"save\", \"delete\"]],\n    template: function AddressComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h4\", 2);\n        i0.ɵɵtext(3, \"Address Information\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(4, AddressComponent_button_4_Template, 3, 0, \"button\", 3);\n        i0.ɵɵtemplate(5, AddressComponent_button_5_Template, 3, 0, \"button\", 3);\n        i0.ɵɵtemplate(6, AddressComponent_div_6_Template, 11, 2, \"div\", 4);\n        i0.ɵɵtemplate(7, AddressComponent_iu_address_form_7_Template, 1, 8, \"iu-address-form\", 5);\n        i0.ɵɵelementStart(8, \"span\", 6);\n        i0.ɵɵtext(9);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", !ctx.editing);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.editing);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.editing);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.editing);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.errorMessage);\n      }\n    },\n    directives: [i2.NgIf, i3.MatButton, i4.MatIcon, i5.InlineAddressComponent, i2.NgForOf, i6.AddressFormComponent],\n    styles: [\".address[_ngcontent-%COMP%]{position:relative;border-radius:4px;background-color:#fff;margin-bottom:10px;width:100%;word-wrap:break-word;background-clip:border-box;border:1px solid rgba(0,0,0,.125);padding-bottom:25px;overflow:auto}.address[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:15px 15px 0;margin-bottom:0;background-color:#fff;border-bottom:none!important}.address[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{padding-left:5px;margin:0;color:#333;font-weight:300;font-size:14px;letter-spacing:1px;line-height:24px;text-decoration:none;background-color:#f5f5f6;border-bottom-width:1px;border-bottom-style:solid;border-color:#0000000f;text-align:-webkit-match-parent}.address[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:15px 15px 10px;min-width:300px}.address[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{color:#1b1b1b;font-size:14px}.address[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{font-size:10pt;color:#1b1b1b}.address[_ngcontent-%COMP%]   .activate-text[_ngcontent-%COMP%]{color:#6d6d6d}.address[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]:hover{color:#aebfbe}.address[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:14px;letter-spacing:1px;line-height:24px;text-decoration:none;color:#6d6d6d;background-color:#f5f5f6;border-bottom-width:1px;border-bottom-style:solid;margin:0 0 0 5px;border-color:#0000000f;text-align:-webkit-match-parent}.address[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#1b1b1b;margin:5px 5px 0 20px}.address[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background-color:#aebfbe}.address[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .example-form-field[_ngcontent-%COMP%]{width:200px;float:right}.address[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{width:100%}.address[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10pt;color:#1b1b1b;margin:5px 5px 0 20px}.address[_ngcontent-%COMP%]   button.action-icon[_ngcontent-%COMP%]{border-radius:50%;width:50px;height:50px;position:absolute;top:14px;right:28px}.address[_ngcontent-%COMP%]   button.action-icon[_ngcontent-%COMP%]   .mat-button-wrapper[_ngcontent-%COMP%]{padding:8px 0;display:inline-block;line-height:24px}.address[_ngcontent-%COMP%]   button.action-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}.address[_ngcontent-%COMP%]   #error-message[_ngcontent-%COMP%]{color:red;position:absolute;bottom:10px;left:50px;font-size:18px}\"]\n  });\n  return AddressComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}